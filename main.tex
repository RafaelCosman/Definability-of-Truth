 %%fakesection preamble
\documentclass[12pt]{article}

%%fakesubsection usepackage
\usepackage[dvips]{graphics,color}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{natbib}
\usepackage{latexsym}
\usepackage{enumerate}
\usepackage{mathtools,cancel,verbatim,hyperref,wasysym}
\usepackage{comment}

%%fakesubsection setlength
\setlength{\parskip}{1pc}
\setlength{\parindent}{0pt}
\setlength{\topmargin}{-3pc}
\setlength{\textheight}{9.5in}
\setlength{\oddsidemargin}{0pc}
\setlength{\evensidemargin}{0pc}
\setlength{\textwidth}{6.5in}
\DeclareMathOperator{\True}{True}
\newbox\gnBoxA
\newdimen\gnCornerHgt
\setbox\gnBoxA=\hbox{$\ulcorner$}
\global\gnCornerHgt=\ht\gnBoxA
\newdimen\gnArgHgt
\def\q #1{%
\setbox\gnBoxA=\hbox{$#1$}%
\gnArgHgt=\ht\gnBoxA%
\ifnum     \gnArgHgt<\gnCornerHgt \gnArgHgt=0pt%
\else \advance \gnArgHgt by -\gnCornerHgt%
\fi \raise\gnArgHgt\hbox{$\ulcorner$} \box\gnBoxA %
\raise\gnArgHgt\hbox{$\urcorner$}}

%%fakesubsection newcommand
\newcommand{\of}[1]{\left(#1\right)}
\newcommand{\Pow}[1]{\mathcal{P}\of{#1}}
\newcommand{\comp}[2]{\left\{ #1 \; \middle\vert \; #2\right\}}
\newcommand{\st}{\; : \;}
\newcommand{\Tq}[1]{True\left(\q{#1}\right)}
\newcommand{\To}[1]{True\left(#1\right)}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\Pc}[2]{\PP\left(#1\;\middle\vert\;#2\right)}
\newcommand{\Po}[1]{\PP\left(#1\right)}
\newcommand{\Pq}[1]{P\left(\q{#1}\right)}
\newcommand{\Pqp}[1]{P'\left(\q{#1}\right)}
\newcommand{\vp}{\varphi}
\newcommand{\Con}[1]{\text{Con}\of{#1}}
\newcommand{\EE}{\mathbb{E}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\HH}{\mathbb{H}}
\newcommand{\zfc}{\mathrm{ZFC}}
\newcommand{\zfcl}{{\zfc_{\cL}}}
\newcommand{\zfcp}{{\zfc_P}}
\newcommand{\zfch}{{\zfc_{\smiley}}}
\newcommand{\pa}{\mathrm{PA}}
\newcommand{\cSL}{{\cS_{\cL}}}
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cL}{L'}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\Godel}[1]{\ulcorner #1 \urcorner}
\newcommand{\inOpen}[1]{#1 \in (a, b)}
\newcommand{\inClosed}[1]{#1 \in [a, b]}

\newcommand{\definitionsOfLsAndTFirst}{Let $T$ be a consistent theory over some language $L$, such that the language admits a G\"odel numbering.
Let $L'$ be the extension of $L$ by a function symbol $P$. }
\newcommand{\definitionsOfLsAndT}{Let $T$ be a consistent theory over some language $L$.
Let $L'$ be the extension of $L$ by a function symbol $P$. }
\newcommand{\Tvar}{$T$-variable}

%%fakesubsection newtheorem
\newcounter{ctr}[section]
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[subsection]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{fact}[theorem]{Fact}
\newtheorem*{fact*}{Fact}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{convention}[theorem]{Convention}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\newenvironment{proofsketch}{%
  \renewcommand{\proofname}{Proof Sketch}\proof}{\endproof}

%%fakesubsection ifs
\newif\ifprocrastinate
\procrastinatefalse

%%fakesubsection authors
\begin{document}
\title{On Reflection \\ }
\author{
Paul Christiano\thanks{UC Berkeley. \ Email: paulfchristiano@eecs.berkeley.edu}
\and
Eliezer Yudkowsky\thanks{Machine Intelligence Research Institute}
\and
Marcello Herreshoff\thanks{Google}
\and
Mihaly Barasz\footnotemark[3]
\and 
Benya Fallenstein\footnotemark[2]
\and
Jessica Taylor\footnotemark[2]
\and 
Kaya Stechly\footnotemark[2]
\and
Rafael Cosman\footnotemark[2]
}
\maketitle
\begin{abstract}
Truth predicates are inconsistent due to liar's sentences such as ``this sentence is false''.
Rather than constructing a \emph{truth} predicate and then assigning \emph{truth values} to sentences, we construct a \emph{probabilistic analogue} to a truth predicate and then assign \emph{probabilities} to sentences, including those that refer to the probabilities of other sentences. %XXX KAYA I recommend that we remove "including those that refer to the probabilities of other sentences." I find this to be confusing both because it breaks the paralell structure and also because it should be implied by the existance of a probabilistic analogue of a truth predicate. Right now it sounds like it might be some sort of property of our language independant of the probabilistic analogue of the truth predicate.
Unlike the standard truth predicate construction, our analogue is consistent and consistently deals with probabilistic generalizations of liar's sentences such as ``this sentence is unlikely''. 
We also prove a negative result: while our analogue works like a truth predicate, we must assign zero probability to the sentence saying it works like a truth predicate.
\end{abstract}
\setcounter{section}{-1}
\section{Introduction}
%%fakesubsection 0.0 actual intro bit
In English, we encounter sentences of the form ``X is true.'' 
To model these in a mathematical theory, we would like a predicate $True$ such that the English sentence from before could be written $True(X)$. Such a predicate, if possible, would `reflect' truth in a theory\footnote{
We take for granted that the language is sufficiently rich that we can assume the existence of a G\"odel numbering. To notate the encoding of some sentence $\vp$, we use G\"odel quotes and write $\q{\vp}$. 
}:
\begin{equation}\label{truth-reflection}
	\vp \iff \Tq{\vp}.
\end{equation}
But, given such a predicate, we could construct the \emph{liar's sentence} $\vp\leftrightarrow\neg\Tq{\vp}$ (``This sentence is false.''), which cannot be assigned a consistent truth value.
Therefore, truth predicates are inconsistent in classical two-valued logic. Yet they may be salvaged by moving to a more expressive framework and relaxing some constraints on how they work.
We investigate such a framework and relaxation based on probabilistic logic.

We want a probabilistic analogue of truth over our language. Our analogue is a function $\PP$ in the metalanguage which assigns probabilities to sentences in the language, even those sentences independent of the theory.
It assigns $1$ to sentences in the theory, $0$ to sentences whose negation is in the theory, and some value in $[0, 1]$ to sentences independent of the theory.

We notate our probabilistic truth predicate with $P$, a function symbol in the language, and require $P$ to reflect $\PP$, probabilistic truth in the theory.
For example, we might want the following \emph{reflection principle} to hold:
\begin{equation}\label{truth-predicate-reflection}
	\PP(\vp)=p \iff \PP(\Pq{\vp}=p) = 1 
\end{equation}
Unfortunately, given this reflection principle, we can construct the liar's sentence $\vp \leftrightarrow \Pq{\vp} < 0.5$ (``This sentence is unlikely''), which cannot be assigned a consistent probability.
We need to weaken principle~(\ref{truth-predicate-reflection}) considerably before we arrive at a non-contradictory construction.

The approach we take is to convert the biconditional to an implication and to allow $P$ to \emph{approximate} $\PP$ rather than requiring it to equal $\PP$ exactly, arriving at the following reflection principle (where $L'$ is the language our theory is defined over):
\begin{equation}\label{reflection-preview}
	\forall \vp \in L' \; \forall a, b \in \mathbb{Q} : \inOpen{\Po{\vp}} \Longrightarrow \Po{\inOpen{\Pq{\vp}}} = 1 .\\
\end{equation}

\subsection{Background and previous work}

To put our work in context, we use a two-factor classification scheme: a theory can have an \emph{outer} notion of \emph{truth}, \emph{probability}, or \emph{both};
and it can have an \emph{inner truth predicate}, \emph{inner probability function},
\emph{both}, or \emph{neither}.

Most of the work of mathematics involves theories that have an outer notion of truth and neither a truth predicate nor an inner probability function. 

Campbell-Moore\cite{campbell14} presents a theory with outer truth, a (restricted) inner truth predicate, and an inner probability function. She defines the reflection principle (which she calls ``introspection'') in her system as $\Tq{\Pq{\vp}<a}\rightarrow\Pq{\Pq{\vp}<a}=1$ and deals with the major paradoxes by assigning ranges of probability to so-called ``problematic sentences.''

Leitgeb\cite{leitgeb08} defines a theory with inner and outer notions of truth and an outer notion of probability which, instead of requiring that $\vp\leftrightarrow\Tq{\vp}$, weakens the truth predicate and assigns the same probability to $\varphi$ and $True(\ulcorner\vp\urcorner)$.
In another paper, Leitgeb\cite{leitgeb12b} extends his theory to two other systems which have outer truth, an inner truth predicate and an inner probability function. These two satisfy his 'probabilistic convention T', that is, $\Pq{\Tq{\vp}}=\Pq{\vp}$. His systems can be shown to satisfy our reflection principle, but have not been extended to expectations.

dispensing with an inner notion of truth lets us focus more closely on the underlying difficulties of reflection in a probabilistic logic.

We work purely with inner and outer probability and outer truth; dispensing with an inner notion of truth lets us focus more closely on the underlying difficulties of reflection in a probabilistic logic.
We also derive an extension of our probabilistic framework which can coherently talk about expectations.

Much work has already been done on developing outer probability distributions.
Gaifman\cite{gaifman64} introduced a set of three conditions for a function from sentences to the reals that are sufficient for the function to be a probability distribution:
\footnote{Gaifman's original formulation was:
\begin{enumerate}
\item If $\vdash \vp$ and $\vdash \psi$ then $\PP(\vp)=\PP(\vp)$
\item If $\vdash \neg (\vp \wedge \phi)$ then $\PP(\vp \vee \psi) = \PP(\vp) + \PP(\psi)$
\item If $\vdash \vp$ then $\PP(\vp) = 1$
\end{enumerate}
It is easy to see that these three conditions are equivalent to those we state.
}
\begin{definition} A probability distribution $\PP$ is \emph{coherent} (with respect to some theory $T$) if:
\label{gaif-coh}
\begin{center}
\begin{tabular}{l r}
1. $\forall \vp: \PP(\vp) \in [0,1]$ & probabilities range from 0 to 1 \\
2. $\forall\vp\in T:\PP(\vp) = 1$ & the probability of any $\vp$ in the theory is 1 \\
3. $\forall \vp \forall \psi: \PP(\vp) = \PP(\vp \wedge \psi) + \PP(\vp \wedge \neg \psi)$ & (because $\vp$ or $\neg \vp$ but not both)
\end{tabular}
\end{center}
\end{definition}

The notion of outer probability that we use is coherent in this sense.

\subsection{Structure of the Paper}
In section~\ref{refl-cons}, we define a reflection principle and prove it consistent. 

In section~\ref{refl-refl}, we prove some impossibility results and show that our principle satisfies only weak versions of some meta-reflective desiderata.

In section~\ref{refl-exp}, we prove 
an alternate characterization of coherence and then use the tools this makes available to derive a reflection principle for expectations.

In section~\ref{nonstandard-models}, we show that our outer probability distribution assigns probability zero to standard theories. We prove that there exists a finitely additive measure that fulfills our desiderata and is supported on standard theories. 

In section~\ref{further-work}, we argue for weakening the reflection principle and mention some open problems. 
\section{The Reflection Principle for Probabilistic Logic}
\label{refl-cons}
%%fakesubsection

In analogy to how the proposed predicate $True$ reflects the notion of truth in the theory, we want a function $P$, in the language, to reflect the outer probability distribution $\PP$.
In this section, we show why the obvious reflection principles fail, define our reflection principle in~\ref{refl-def}, and prove it is consistent in~\ref{ref-cons-pf}.

$True$ attempted to satisfy the reflection principle
\begin{equation}
\vp \iff True(\q{\vp}).
\end{equation}
We might want $P$ to satisfy
\begin{equation}\label{truth-predicate-reflection-2}
\PP(\vp)=p \iff \PP(\Pq{\vp}=p) = 1 .
\end{equation}
But, this falls immediately to the liar's sentence $G \leftrightarrow \Pq{G} < 0.5$ (``This sentence is unlikely''). We sketch out the proof.

\begin{proofsketch}
Assume $\PP(\vp)=p \iff \PP(\Pq{\vp}=p) = 1$.
Then we use the diagonal lemma to construct the sentence (in the language) $G \leftrightarrow \Pq{G} < 0.5$.
We show that $\PP(G)=0.5$ with a double proof by contradiction:

Say $\PP(G)<0.5$. 
By reflection, we have $\PP(\Pq{G}<0.5)=1$.
But, (by coherence; see definition~\ref{gaif-coh}) this is equivalent to $\PP(G)=1$, a contradiction. A similar argument proves that $\PP(G)$ cannot be greater than $0.5$.

Thus, $\PP(G)=0.5$, and so $\PP(\Pq{G}=0.5)=1$.
Applying the liar's sentence, we get that $\PP(G)=0$, a contradiction.
\end{proofsketch}

We might try to deal with the liar's paradox by weakening our reflection principle and replacing the biconditional with an implication:
\begin{equation}\label{one-direction-truth-predicate-reflection}
\PP(\vp)=p \Rightarrow \PP(\Pq{\vp}=p) = 1.
\end{equation}
However, this falls to the same liar's sentence as before. Instead of letting $P$ exactly reflect $\PP$, we might let it have arbitrarily precise information about $\PP$.
For any open interval $(a, b)$ containing $\Po{\vp}$,
a sufficiently accurate approximation to $\Po{\vp}$
would let us conclude $\Po{\vp} \in (a, b)$.
In this vein we might consider the following reflection principle:
\begin{equation}\label{literal-reflection}
\forall a, b \in \mathbb{Q} : \inOpen{\PP(\vp)} \iff \PP(\inOpen{\Pq{\vp}}) = 1 .
\end{equation}
But, this again falls to the same liar's sentence. However, combining the two attempts and to get a one directional, approximate reflection principle is sufficient to construct a reflection principle which avoids the issues we just encountered.

\begin{definition}
\label{refl-def}
\definitionsOfLsAndTFirst
Let $\PP$ be a coherent probability distribution over $L'$. $\PP$ is \emph{reflective} if
\begin{equation}\label{reflection}
\forall \vp \in L' \; \forall a, b \in \mathbb{Q} : \inOpen{\Po{\vp}} \Longrightarrow \Po{\inOpen{\Pq{\vp}}} = 1 .\\
\end{equation}
\end{definition}

Note that the reverse implication is necessarily false (as otherwise we would have a biconditional); however, it is easy to see that condition~\ref{reflection} is equivalent to
\begin{equation}\label{reverse-reflection}
\forall \vp \in L' \; \forall a, b \in \mathbb{Q} : \inClosed{\Po{\vp}} \Longleftarrow \Po{\inClosed{\Pq{\vp}}} > 0.
\end{equation}
Note the reverse implication, the closed intervals, and that it is greater than zero rather than an equal to one. We use this \emph{reverse reflection principle} in some of the proofs in section~\ref{refl-refl}.

Given a theory $T$, we would like to obtain a coherent, reflective $\PP$ over $T$.

\begin{theorem} \emph{Consistency of the Reflection Principle}:
\label{ref-cons-pf}
\definitionsOfLsAndT
There exists a coherent probability distribution $\PP$ which satisfies the reflection principle:
$$\qquad \qquad \forall \vp \in L' \ \forall a,b\in \mathbb{Q}: \inOpen{\Po{\vp}} \Rightarrow \PP(\inOpen{\Pq{\vp}})=1.$$
\end{theorem}
\begin{proof}
Take the set $\mathcal{A}$ of all coherent probability distributions over $L'$ which assign probability one to all sentences in $T$ and consider it as a subset of $[0,1]^{L'}$ with the product topology.
Define a relation $R\subset \mathcal{A}^2$ as
$$pRq \iff \forall \vp \in\cL\;\forall a,b\in\mathbb{Q}:\inOpen{p(\vp)}\Rightarrow q(\inOpen{\Pq{\vp}})=1$$
$\PP$ satisfies the reflection principle if and only if $\PP R \PP$.
To prove reflective distributions exist, we use Kakutani's fixed point theorem.

Kakutani's fixed point theorem states that there exists $p \in \mathcal{A}$ such that $pRp$, given that the following hold:
(1) $\mathcal{A}$ is a subset of a locally convex Hausdorff topological vector space,
(2) $\mathcal{A}$ is nonempty,
(3) $\mathcal{A}$ is compact,
(4) $\mathcal{A}$ is convex,
(5) $R$ has a closed graph (i.e. $R$ is a closed subset of $\cA^2$),
(6) $\forall p\in\mathcal{A}\, \exists q\in\mathcal{A}: pRq$, and
(7) $\forall p\in\mathcal{A}: \{q \in \mathcal{A}: pRq\}$ is convex\cite{kakutani41}.
We will show that all the above properties hold for $\cA$ and $R$.
\begin{enumerate}

\item \emph{$\mathcal{A}$ is a subset of a locally convex Hausdorff topological vector space.}
$\mathcal{A}\subset [0, 1]^{L'}\subset R^{L'}$ which is a locally convex Hausdorff topological vector space.

\item \emph{$\mathcal{A}$ is nonempty}.
$T$ is consistent, so we construct a completion $T^{*}$ in the language $\cL$.
Let $\PP(\vp) = 1$ for all $\vp$ in $T^{*}$ and $\PP(\vp) = 0$ otherwise.
$\PP$ is coherent, thus $\PP\in\mathcal{A}$.

\item \emph{$\mathcal{A}$ is compact.}
$\cA$ is a subset of the compact space $[0,1]^{L'}$, so it suffices to show that $\mathcal{A}$ is closed.

Let $p$ be in the closure of $\mathcal{A}$.
Take a sequence in $\mathcal{A}$ of points $p_i$ converging to $p$.
Since we are in the product topology, convergence in $\mathcal{A}$ is equivalent to convergence of $p_i(\vp)$ in $[0,1]$ for every $\vp$.
To prove $p\in\mathcal{A}$, we show that $p$ satisfies the Gaifman conditions.

Fix sentences $\vp,\psi$.
\begin{itemize}
\item \emph{$p(\vp)\in [0,1]$.}
$p_i(\vp)$ is a convergent sequence of real numbers in $[0, 1]$.
Thus they converge within $[0,1]$, so $p(\vp)\in[0,1]$.
\item \emph{If $\vp\in T$, then $p(\vp)=1$.}
Every $p_i$ is coherent, so $p_i(\vp)=1$ for all $i$. Thus $p_i$ converges to one.
\item $p(\vp)-p(\vp\wedge\psi)-p(\vp\wedge\neg\psi)=0$.
(We have rewritten the condition to make this part clearer.)
Since every $p_i$ is coherent, $p_i(\vp) -p_i(\vp\wedge\psi)-p_i(\vp\wedge\neg\psi)=0.$
This is a sequence of zeroes, so it converges to zero.
\end{itemize}
Thus, $p$ is coherent. Therefore, $\mathcal{A}$ is closed and thus compact.
\item \emph{$\mathcal{A}$ is convex.}
Given any $p,r\in\mathcal{A}$, we will show that if $q$ is a convex combination of $p$ and $r$, then $q$ is coherent and therefore is in $\mathcal{A}$.
Fix a sentence $\vp$.
\begin{itemize}
\item \emph{$q(\vp) \in [0, 1]$}.
We know that $p(\vp) \in [0,1]$ and $r(\psi) \in [0,1]$.
Thus a linear combination of the two must be in $[0,1]$.
\item \emph{If $\vp\in T$, then $p(\vp)=1$.}
Assume $\vp\in T$.
Then, $p(\vp)=1$ and $r(\vp)=1$, so any convex combination of ones must be one.
Thus, $q(\vp) = 1$.
\item \emph{$\forall \psi: r(\vp) -r(\vp\wedge\psi)-r(\vp\wedge\neg\psi)=0$.}
The condition holds for $p(\vp)$ and $r(\vp)$.
Since convex combinations of zeroes are zero, $q(\vp)=0$.
\end{itemize}
Therefore $r\in\mathcal{A}$, so $\mathcal{A}$ is convex.

\item \emph{$R$ has a closed graph.}
Consider a convergent infinite sequence $(p_i,q_i)$ such that $\forall i:p_iRq_i$ which converges to $(p,q)$.
We show that $pRq$.
Fix $\vp, a, b$ such that $\inOpen{p(\vp)}$.
Since $p_i$ converges to $p$, $\exists N \forall i > N: \inOpen{p_i(\vp)}$.
By definition, $\forall i>N: q_i(\inOpen{\Pq{\vp}}) = 1$, so $q(\inOpen{\Pq{\vp}}) = 1$, that is, $pRq$.
Thus, $R$ has a closed graph.

\item \emph{$\forall p\in\mathcal{A} \exists q\in\mathcal{A}: pRq$.}
Fix a $p$. Take a completion $T^*$ of $T +$ the schema of statements $\inOpen{\Pq{\vp}}$ where $\inOpen{p(\vp)}$.
This completion is consistent because $p$ is coherent.
Let $q$ assign $1$ to all statements in $T^*$ and $0$ to all others.
Then $q$ is coherent and $pRq$.

\item \emph{$\forall p\in\mathcal{A}: \{q \in \mathcal{A}: pRq\}$ is convex.}
Let $q_0, q_2\in\{q \in A: pRq\}$, and let $q_1$ be any convex combination of $q_0$ and $q_2$.
We show that $pRq_1$, and therefore $q_1\in\{q \in A: pRq\}$.
Choose $\vp, a, b$ such that $\inOpen{p(\vp)}$.
Because $pRq_0$ and $pRq_2$, we have that $q_0(\inOpen{\Pq{\vp}}) = 1$ and $q_2(\inOpen{\Pq{\vp}}) = 1$.
Thus $q_1(\inOpen{\Pq{\vp}}) = 1$
Since $\mathcal{A}$ is convex, $q_1\in\mathcal{A}$, so $pRq_1$.
Therefore, $\{q \in A: pRq\}$ is convex.
\end{enumerate}

Thus, by Kakutani's fixed point theorem, $R$ has a fixed point, which is, by definition, a coherent, reflective distribution.
\end{proof}
\section{Reflection about Reflection: an Impossibility Result}
\label{refl-refl}
%%fakesubsection

The reflection principle for truth predicates is a statement in the metalanguage:
$$\vp \iff \Tq{\vp}.$$
If truth predicates worked, a natural next desideratum would be for the theory to prove that the truth predicate works. Specifically, we might want the theory to prove
$$\vp \leftrightarrow \Tq{\vp}.$$
Note the difference between $\leftrightarrow$, the biconditional in the language, and $\iff$, the biconditional in the metalanguage.

Analogously, now that we have proven that $P$ reflects $\PP$, we might additionally want $\PP$ to assign high probability to the statement that $P$ is reflective and coherent. We show that no reflective, coherent~$\PP$ believes that $P$ is reflective, and that any coherent~$\PP$ which does believe that $P$ is reflective is not itself reflective. We do show that $\PP$ can assign high probability to $P$ being coherent, thus preserving some of the structure of $\PP$ in $P$.

\subsection{The Inner Reflection Principle}
The reflection principle is stated in the metalanguage, and is a 
\emph{statement which is true about $\PP$},
not an axiom in $T$ to which $\PP$ assigns probability 1.
In contrast to this principle, which we can think of as an \emph{outer reflection principle}, we might also want $\PP$ to assign probability 1 to $P$'s reflective consistency.
To this end, define the \emph{inner reflection principle} as~\footnote{Note that the quantification here is in the metalanguage.
    An even stronger inner reflection principle would have the quantification on the inside. That is,
    $$\forall\vp\in L' : \PP(\forall a,b\in\mathbb{Q} : \Pq{\vp}\in(a,b)\rightarrow\Pq{\Pq{\vp}\in(a,b)}=1)=1$$
    Or even
    $$\PP(\forall\q{\vp} \ \forall a,b\in\mathbb{Q} : \Pq{\vp}\in(a,b)\rightarrow\Pq{\Pq{\vp}\in(a,b)}=1)=1$$
    (where 
    $\forall \q{\vp}$
    is quantifying over all (valid) encodings in the language, which might be, for example, 
    $\mathbb{N}$.) The impossibility results in this section are proved for the weak version, and so carry for these two stronger versions trivially.}:
$$\forall\vp\in L' \ \forall a,b\in\mathbb{Q}:\PP(\Pq{\vp}\in(a,b)\rightarrow\Pq{\Pq{\vp}\in(a,b)}=1)=1.$$
Note that this is just the outer reflection principle with $\PP$s converted to $P$s and wrapped inside of $\PP(\dots)=1$.

We prove that there exist \emph{coherent} inner reflective $\PP$s, but no coherent, inner reflective $\PP$ can also be outer reflective.

\begin{proposition} \emph{Existence of an Inner Reflective $\PP$.}
\definitionsOfLsAndT Then there exists a coherent probability distribution $\PP$ which satisfies the inner reflection principle:
$$\forall\vp\in L' \ \forall a,b\in\mathbb{Q}:\PP(\Pq{\vp}\in(a,b)\rightarrow\Pq{\Pq{\vp}\in(a,b)}=1)=1$$
\end{proposition}
\begin{proof}
By the consistency of the reflection principle, there exists a coherent, reflective $\PP'$ over $T$.
Take a completion of $T^*$ of $T+$ the schema of statements $\Pq{\vp}\in(a,b)$ where $\PP'(\vp)\in(a,b)$.
This completion is consistent because $\PP'$ is coherent.
Take a coherent distribution $\PP$ over $T^*$.

By the way that we defined it, $\PP$ satisfies the inner reflection principle (though not necessarily the outer reflection principle).
\end{proof}

\begin{proposition} \emph{Impossibility of Satisfying both Inner and Outer Reflection}
\definitionsOfLsAndT
There exists no coherent probability distribution $\PP$ which assigns probability one to every sentence in $T$ and satisfies both the inner and outer reflection principles. In fact, any coherent, reflective probability distribution $\PP$ must assign probability $0$ to inner reflection.
\end{proposition}
\begin{proof}
We proceed with a proof by contradiction.
Assume there exists a coherent, reflective probability distribution $\PP$ which satisfies
$$\forall a,b\in\mathbb{Q}\forall\vp\in L':\PP(\Pq{\vp}\in(a,b)\rightarrow\Pq{\Pq{\vp}\in(a,b)}=1)=1.$$

% TODO MATH - fix this proof

Choose a $\vp$ such that $\Po{\inClosed{\Pq{\vp}}} > 0$.

By the outer reflection principle we have $\Po{\Pq{\inClosed{\Pq{\vp}}} > 0} = 1.$

Applying the reverse inner reflection principle
\footnote{
The reverse inner reflection principle is 
$$\forall \vp \in L' \; \forall a, b \in \mathbb{Q} : \inClosed{\Pq{\vp}} \leftarrow \Pq{\inClosed{\Pq{\vp}}} > 0.$$
Note the reverse implication, the closed intervals, and the `greater than zero' in place of the usual `equals one'.
This reverse principle is derived analogously to the reverse outer reflection principle (principle~\ref{reverse-reflection} in section~\ref{refl-cons}).
}
obtains $\Po{\inClosed{\Pq{\vp}}} = 1$

%This is a contradiction, as $\PP$ must assign the same value to inner reflection and its contrapositive.
This is  now a decider, a $\PP$ which assigns $0$ or $1$ to every sentence, thereby acting as a truth predicate. Which is a contradiction.
% TODO MATH - fix the above paragraph

A similar argument shows that any coherent, reflective $\PP$ must assign probability $0$ to inner reflection.
\end{proof}
Not all is lost. Every coherent, reflective probability distribution $\PP$ satisfies a weaker version of the inner reflection principle.
\begin{proposition} \emph{Weaker Inner Reflection.}
Every coherent, reflective probability distribution $\PP$ satisfies
$$\forall\vp\in L' \ \forall a,b,\varepsilon > 0 \in\mathbb{Q}:\PP(\Pq{\vp}\in(a,b)\rightarrow\Pq{\Pq{\vp}\in(a,b)}>1-\varepsilon)=1.$$

Note that this is weaker entirely due to the internal `$>1-\epsilon$' in place of the usual `$=1$'.
\end{proposition}
\begin{proof}
%TODO MATH fix this proof
Assume that $\Pq{\vp}\in (a,b)$ is a theorem.
%TODO MATH Then, $\PP(\vp)\in(a,b)$.
By the contrapositive of the reflection principle, we have that
$$\PP(\Pq{\vp}\in(a,b))=1.$$
We can then derive 
$$1-\varepsilon<\PP(\inOpen{\Pq{\vp}})<1+\varepsilon.$$
Applying the reflection principle, we get that, in $T$, we've proved
$$\Pq{\vp}\in (a,b)\rightarrow\Pq{\inOpen{\Pq{\vp}}}>1-\varepsilon.$$
Since $\PP$ assigns probability one to theorems of the theory, this is sufficient to prove the proposition.
\end{proof}

We would also like $\PP$ to assign probability $1$ to $P$ being coherent.
Let $Coh(P)$ be the sentence stating that $P$ is coherent:
$$\forall \vp: (\Pq{\vp} \in [0, 1]) \wedge (\vp \rightarrow \Pq{\vp}=1) \wedge (\forall \psi: \Pq{\vp} = \Pq{\vp \wedge \psi} + \Pq{\vp \wedge \neg \psi})$$
Note that this is just an representation of the Gaifman conditions in the language.
\begin{proposition}
There exists a coherent, reflective probability distribution $\PP$ such that $\PP(Coh(P))=1$.
\end{proposition}
\begin{proof}
This follows from some simple modifications to the consistency of the reflection principle proof.
%TODO MATH actually check this. Or write a full proof of this result
\end{proof}
\section{The Reflection Principle for Expectations}
\label{refl-exp}
%%fakesubsection purpose of this section
A natural extension of our framework is to analogues of random variables and their expectations. 
In this section we develop one approach to this, introducing a reflection principle for expectations.
Along the way, we give an alternate characterization of a ``coherent probability distribution'' as a probability distribution over a Stone space of complete theories (with its associated $\sigma$-algebra), which makes many new mathematical tools available to the study of our system.

Our metalanguage is $\zfc$ + the existence of a strongly inaccessible cardinal.
Let $\cL := \{\in,P\}$ be the language of set theory extended by a single constant symbol $P$, and let $\zfcl$ denote $\zfc$ with all axiom schemas ranging over formulas in~$\cL$.
\begin{definition}
Let $\cSL$ denote the Stone space of complete theories over~$\cL$; given a consistent theory~$T$, let $\cS_T\subseteq\cSL$ denote the subspace of all complete theories extending~$T$. ($\cS_T$ is itself a Stone space.) 

We will sometimes simply write $\cS$ if it is clear from the context what $T$ is or which $T$ may be chosen.
We write $\Delta(\cS)$ for the set of probability distributions over $\cS$ with its Borel-$\sigma$-algebra.
We call the elements of $\Delta(\cS_T)$ the \emph{coherent probability distributions over~$T$}. 
Note that these distributions are \emph{not} functions from the language to $[0,1]$, unlike our previous definition of a coherent distribution. 
We are justified in calling them the same thing because elements of $\Delta(\cS_T)$ correspond to Gaifman coherent distributions from the language.
\end{definition}
For $S\subseteq T$, we have $\cS_T\subseteq\cS_S$, and hence $\Delta(\cS_T)$ is a subset of $\Delta(\cS_S)$.
\subsection{\Tvar{}s and their Expectations}
We construct analogues of random variables in our system and prove that their expectations are well defined.

Intuitively, we choose a theory $T$ and let any formula $\vp(x)$ define a 'random variable' if $T$ can prove that there is a unique value which satisfies $\vp$.
$$\vp(x) \leftrightarrow (x = 0 \wedge \psi) \vee (x = 1 \wedge \neg \psi)$$
If $\psi\in T$ then $\vp(0)$, but if $\neg \psi\in T$ then $\vp(1)$. 
However, $\psi$ may be independent of $T$, in which case $T$ can prove $\vp(0)\vee\vp(1)$, but cannot prove either of the statements in the disjunction.
Given a distribution $\nu\in \Delta(\cSL)$, we can restrict $\nu$ to a distribution over the values satisfying $\vp$.
We think of this distribution as analogous to a random variable.

\begin{definition}
Let $T$ be a theory extending $\zfcl$. 
A \emph{\Tvar{}}
is given by a one-parameter formula $\vp(x)$ of $\cL$ such that $T\vdash\big(\exists!x:\vp(x)\big)\wedge\big(\forall x:\vp(x)\to x\in\RR\big)$. 
We denote a \Tvar{} with capital letters, especially $X$, since we will consider them random variables on~$\cS_T$.
We write $T\vdash\psi(X)$ to mean $T\vdash\forall x.\;\vp(x)\to\psi(x)$.

We say that ``\emph{$X\in[a,b]$ is a \Tvar{}}'', where $a<b\in\RR$, if $X$ is a \Tvar{} and for all $a',b'\in\QQ$ such that $a'\le a$ and $b\le b'$, we have $T\vdash\dot a'\le X\le \dot b'$.
A \Tvar{} $X$ is \emph{bounded} if there are $a,b\in\RR$ such that $\inClosed{X}$.
\end{definition}
\begin{definition}
If $X$ is a \Tvar{} and $S\in\cS_T$, let
\[X(S) \;\,:=\;\, \sup\;\{q\in\QQ \;:\; S\vdash \dot q \le X\} \;\,\in\;\, [-\infty,\infty].\]
\end{definition}
We consider $X(S)$ as the \emph{standard part} of the value that the theory $S$ assigns to $X$: it's possible that the actual value is nonstandard in all models of $S$ (e.g., it could be that $X(S) = 0$, but $S\vdash X>0$ or $S\vdash X<0$).
\begin{lemma}
If $X\in[a,b]$ is a \Tvar{} and $S\in\cS_T$, then $X(S)\in[a,b]$.
\end{lemma}
\begin{proof}
%TODO MATH check this proof more thoroughly. Esp. why are there two in the section with b's and only one in the section with a's.
If $X(S) < a$, then there is some $a'\in\QQ$ with $X(S) < a' \le a$. 
Then by assumption we have $T\vdash\dot X\geq a'$, and hence $S\vdash\dot X\geq a'$, but this implies $X(S)\ge a'$, contradiction.
Similarly, if $X(S) > b$, then $X(S) > b'' > b' \ge b$ for some $b',b''\in\QQ$, whence $S\vdash X\le\dot b'$ and therefore $S\vdash X<\dot b''$, implying $X(S) \le b''$, contradiction.
\end{proof}
\begin{lemma}
Suppose that $X$ is a \Tvar{}, and let $a<b\in\RR$. Then, the set $A := \{S\in\cS_T : a< X(S)<b\}$ is open in $\cS_T$.
\end{lemma}
\begin{proof}
Let $A(a',b') := \{S : S\vdash\dot a' < X < \dot b'\}$ for $a',b'\in\QQ$. 
This set is open, because for any $\vp$, the set of all theories containing $\vp$ is open. 
%TODO MATH how does this bit work? check it and then write in some bit to maybe explain it.

We show that $A$ is the union of all $A(a',b')$ with $a < a' < b' < b$, that is $\bigcup A(a',b')$.

For the inclusion $A \subseteq \bigcup A(a',b')$, suppose that $S\in A$; then $a < X(S) < b$, so there are $a',b'\in\QQ$ such that $a<a'<X(S)<b'<b$.
Since the inequalities are strict, we can conclude $S\vdash X > \dot a'$ and $S\nvdash X > \dot b'$, i.e.\ $S\vdash\dot a' < X < \dot b'$, and thus $S\in A(a',b')$.

For the other direction, we show $\bigcup A(a',b')\subseteq A$. 
Suppose that $a < a' < b' < b$ and $S\in A(a',b')$.
Then $a' \le X(S) \le b'$ and hence $a < X(S) < b$, implying $S\in A$.
\end{proof}
\begin{theorem}
Suppose that $X\in[a,b]$ is a \Tvar{}. Then the mapping $X(\cdot)$ from $\cS_T$ to $[a,b]$ is continuous (and, in particular, Borel-measurable).
\end{theorem}
\begin{proof}
By the previous lemma, $X^{-1}((a',b'))$ is open for every open interval $(a',b')$.

\end{proof}
\begin{corollary}
If $X\in[a,b]$ is a \Tvar{} and $\nu\in\Delta(\cS_T)$, then $\EE[X]\in[a,b]$, where $\EE[X] := \int X(S)\,d\nu(S)$; in particular, the expectation of bounded \Tvar{}s is well-defined and has its usual properties, such as linearity.
\end{corollary}
\subsection{An Alternative View of coherent Distributions} \label{An Alternative View of coherent Distributions}
Intuitively, a coherent distributions is a measure over completions of a theory. 
It assigns to every sentence $\psi$ a probability corresponding to the `fraction' of the completions that include $\psi$.

Formally, a $\nu\in\Delta(\cS)$ assigns a probability to every sentence~$\vp$ in the language~$\cL$, by setting $\PP(\vp) := \nu(\{S\in\cS:S\vdash\vp\})$. (Note that this is defines a Gaifman coherent distribution.
)
This defines a mapping $\iota : \Delta(\cS)\to [0,1]^\NN\subset\RR^\NN$, where we consider $\RR^\NN$ to be endowed with the product topology. 
(The exponent~$\NN$ comes from some enumeration of the sentences of~$\cL$.)
Intuitively, $\iota$ maps a distribution in $\Delta(\cS)$ to its assignments over $\cL$.

We show that $\iota$ is an injection and has compact range, and then that it preserves the topology of $\Delta(\cS)$.
\begin{definition}
The \emph{standard base} of $\cS$ is the collection of all sets of the form $\{S\in\cS : S\vdash\vp\}$, where $\vp$ is a sentence of~$\cL$.
\end{definition}
Note that the standard base forms a Boolean algebra.
\begin{theorem}
$\iota$ is a bijection between~$\Delta(\cS)$ and the set of finitely additive probability measures on the standard base of~$\cS$.
\end{theorem}
%TODO MATH check this math and then figure out how it fits so that it can be motivated better.
\begin{proof}
Since the standard base of $\cS$ is a Boolean algebra, it is in particular a ring of sets. Furthermore, this ring generates our $\sigma$-algebra: since the sets in the ring form a countable base of $\cS$, every open set is a countable union of base sets (so that the smallest $\sigma$-algebra containing the open sets is also the smallest $\sigma$-algebra containing the base).
Now, a finitely additive measure~$\nu$ on a ring is already a premeasure (i.e., $\sigma$-additive on the ring) if for every descending sequence $A_n\supseteq A_{n+1}$ of elements of the ring, $\lim \nu(A_n) > 0$ implies $\textstyle\bigcap_n A_n \neq\emptyset$, and a premeasure on a ring extends uniquely to a measure on the generated $\sigma$-algebra. 

Now, by the assumption, we have $\nu(A_n) > 0$ and therefore $A_n\neq\emptyset$ for all $n\in\mathbb{N}$; since $\textstyle A_n = \bigcap_{i=1}^n A_i$, this means that the family $(A_n)$ has the finite intersection property, and so since Stone spaces are compact and each $A_n$ is clopen, the intersection of all $A_n$ is non-empty as desired.
\end{proof}
\begin{corollary}
$\iota$ has compact range.
\end{corollary}
\begin{proof}
The range of $\iota$ is contained in $[0,1]^\NN$, which is compact by Tychonoff's theorem. Thus, it suffices that the range is closed. But it is easy to see that the set of all finitely additive probability measures on the standard base is closed in $[0,1]^\NN$.
\end{proof}
We consider $\Delta(\cS)$ to be endowed with the topology of \emph{weak convergence of measures}. (Outside probability theory, this is known as the weak-$*$ topology.)
\begin{theorem}
$\iota$ is a homeomorphism.
\end{theorem}
\begin{proof}
The Stone space of a Boolean algebra is metrizable if and only if the Boolean algebra is countable, so since the standard base of $\cS$ is countable, the notion of weak convergence of probability measures on our space is well-defined. One of the equivalent definitions is that $\nu_n\to\nu$ if $\liminf\nu_n(B)\ge\nu(B)$ for all open sets $B$. We want to show that this is equivalent to convergence in the product topology on $[0,1]^\NN$, which amounts to pointwise convergence of $\nu_n(A)$ to $\nu(A)$ for all $A$ in the standard base.
Suppose first that $\nu_n(A)\to\nu(A)$ for all base sets $A$ and let $B$ be an arbitrary open set. $B$ can be written as a countable union $\textstyle\bigcup_m A_m$ of base sets; since the base is closed under Boolean operations, it follows that it can be written as a countable disjoint union (let $\textstyle A_m' := A_m\setminus\bigcup_{i=1}^{m-1}A_i)$. For any $\epsilon>0$, there is an $m\in\mathbb{N}$ such that $\textstyle\nu(B)\le\nu(\bigcup_{i=1}^m A_i)+\epsilon/2$. By pointwise convergence, for sufficiently large $n$ we have $\nu(A_i)\le\nu_n(A_i) + \epsilon/2m$ for all $i\le m$. Therefore,
\[
\textstyle\nu(B)\;\le\;\sum_{i=1}^m\nu(A_i)+\epsilon/2\;\le\;\sum_{i=1}^m\nu_n(A_i) + \epsilon\;\le\;\nu_n(B)+\epsilon.
\]
Since this holds for all $\epsilon$, the desired inequality follows.
Suppose now that $\liminf\nu_n(B)\ge\nu(B)$ for all open sets $B$. We must show that for all base sets $A$, $\nu_n(A)\to\nu(A)$. But base sets are clopen, so we have both $\liminf\nu_n(A)\ge\nu(A)$ and
\[
\limsup\nu_n(A) \;=\; 1-\liminf\nu_n(A^c) \;\le\; 1 - \nu(A^c) \;=\; \nu(A),
\]
implying $\lim\nu_n(A) = \nu(A)$.
\end{proof}
\subsection{The Reflection Principle for Expectations}
\begin{definition}
A theory $T$ in the language $\cL$ is \emph{meditative} if it is consistent and there is a Grothendieck universe $\cU$ such that for every $\nu\in\Delta(\cS_T)$, we have $(\cU,\nu)\vDash T$.
\end{definition}
The proof of the following theorem is analogous to the proof of consistency of the reflection principle in theorem~\ref{ref-cons-pf}.
We define a relation $R$ over the proper space and then appeal to Kakutani's fixed point theorem.
\begin{theorem}
For every meditative theory $T$, there is a $\nu\in\Delta(\cS_T)$ such that for every bounded \Tvar{}~$X$ and all $a,b\in\QQ$,
\[a<\EE[X]<b\;\implies\;\PP(\dot a < E[X] < \dot b) = 1,\]
where $\PP:=\iota(\nu)$.
\end{theorem}
\begin{proof}
Let $\cA$ be the range of the embedding $\iota$. Define $R$, such that $\iota(\nu)R\iota(\nu')$ if for every bounded \Tvar{}~$X$ and all $a,b\in\QQ$ such that $a<\EE[X]<b$, we have $\PP'(\dot a < E[X] < \dot b)= 1$, where $\PP':=\iota(\nu')$.

We employ Kakutani's fixed point theorem to find a fixed point of $R$. Recall that Kakutani's fixed point theorem requires that:
(1) $\mathcal{A}$ is nonempty.
(2) $\mathcal{A}$ is compact.
(3) $\mathcal{A}$ is convex.
(4) $\mathcal{A}$ is a subset of a locally convex Hausdorff topological vector space.
(5) $R$ has a closed graph (i.e. $R$ is a closed subset of $\cA$).
(6) $\forall x\in\cA \exists y\in\cA : xRy$.
(7) $\forall x\in\cA:\{y \in \mathcal{A}: xRy\}$ is convex.
\cite{kakutani41}.

\begin{enumerate}
\item \emph{$\mathcal{A}$ is nonempty}. There exists a $\nu\in\Delta(\cS_T)$ since $T$ is consistent, so $\iota(\nu)\in\cA$, which is therefore non-empty.

\item \emph{$\mathcal{A}$ is compact.} This follows from corollary 3.2.3.

\item \emph{$\mathcal{A}$ is convex.} $\Delta(\cS_T)$ is convex, and $\iota$ clearly preserves convex combinations.

\item \emph{$\mathcal{A}$ is a subset of a locally convex Hausdorff topological vector space.} $\mathcal{A}$ is a compact subset of the locally convex topological vector space~$\RR^\NN$.

\item \emph{$R$ has a closed graph.} Given $\nu_n,\nu'_n,\nu,\nu'\in\Delta(\cS_T)$ such that $\nu_n\to\nu$, $\nu'_n\to\nu'$, and $\forall n : \iota(\nu_n)R\iota(\nu'_n)$, we need to prove that $\iota(\nu)R\iota(\nu')$. 
To do this, we make use of the fact that if $\nu_n$ converges weakly to $\nu$ (i.e., converges in the weak-$*$ topology that we have put on $\Delta(\cS_T)$), then $\EE_n[X]\to\EE[X]$ for every bounded, continuous function $X : \cS_T\to\RR$, and, in particular, for every bounded \Tvar{}~$X$. 
Thus, if $a < \EE[X] < b$, then $a < \EE_n < b$ for all~$n$ greater than some~$n_0$, and hence $\PP'_n(\dot a < E[X] < \dot b) = 1$ for all $n>n_0$.
Since $\iota(\nu'_n)$ converges pointwise to $\iota(\nu')$, this implies that $\PP'(\dot a < E[X] < \dot b) = 1$.

\item \emph{$\forall x \exists y$ s.t. $xRy$.} Let $\delta_{T(\cU,\nu)}$ be the distribution that assigns probability~1 to~$T(\cU,\nu)$, the complete theory of the model~$(\cU,\nu)$. Then, $\iota(\nu)R\iota(\delta_{T(\cU,\nu)})$.

\item \emph{$\forall x$ the set $\{y \in \mathcal{A}: xRy\}$ is convex.} $\cA$ is convex. $\{y\in\cA:xRy\}$ is the intersection of $\cA$ and each set $\{v\in\RR^\NN : v(n) = 1\}$ where $n$ is the G\"odel number of some statement of the form $\dot a < E[X]<\dot b$ which is assigned probability one.
\end{enumerate}
Thus, by Kakutani's fixed point theorem, there exists a $\PP\in\cA$ such that 
$\PP R\PP$, so it must be reflective in the manner we desired.

\end{proof}
\subsection{Enlightened theories}
In this subsection, we develop an alternate approach to reflection about reflection, showing that more structure can be consistently required of the inner language symbol $P$.
\begin{definition}
Let $\zfcp := \zfcl + P\in\Delta(\cS_\zfcl)$.
\end{definition}
\begin{definition}
A theory $T$ is \emph{enlightened} if it is meditative, extends $\zfcp$, and satisfies $T\vdash P[\vp] = 1$ for every $\vp\in T$.
\end{definition}
It would be even better if we could have $T\vdash\zfcl + P\in\Delta(\cS_T)$ (for which $T$ of course needs to be definable). However, for $\cS_T$ to be well-defined, $T$ must be consistent, and any recursively enumerable $T$ that believes its own consistency is inconsistent by the second incompleteness theorem.
If there are any enlightened theories, then there is a least enlightened theory, namely the least fixed point of the equation $T = \zfcp + \{P[\vp] = 1 : \vp\in T\}$. But it is not a priori clear that this theory is meditative, or even that it is consistent. 

We now show that enlightened theories exist.
Fix some Grothendieck universe $\cU$. (By our assumption that a strongly inaccessible cardinal exists, there is at least one Grothendieck universe.) Recall that $\cU$ is a model of ZFC (with~$\in$ interpreted as the standard membership relation), and that all ``small'' sets (such as $\RR$ and $\Delta(\cS_T)$) are the same in~$\cU$ as in the class~$\mathbf{V}$ of all sets.
\begin{definition}
Use transfinite recursion to define a sequence $\cT_\alpha$ of $\cL$-theories as follows: Let $\cT_{<\alpha} := \bigcup_{\beta<\alpha} \cT_\beta$, and set $\cT_\alpha := \bigcap_{\nu\in\Delta(\cS_{\cT_{<\alpha}})} T(\cU,\nu)$, where $T(\cU,\nu)$ denotes the complete theory of $(\cU,\nu)$, which extends~$\cU$ to a model of~$\cL$ by interpreting $P$ as $\nu$.
Let $\cT := \bigcup_\alpha \cT_\alpha$.
\end{definition}
In order for $\cT_\alpha$ to be well-defined, $\cT_{<\alpha}$ must be consistent. We now show that this is the case for all~$\alpha$.
Note first that if $\alpha\le\beta$, and $T_\gamma$ is defined for all $\gamma<\beta$, then $\cT_{<\alpha}\subseteq\cT_{<\beta}$. Moreover, as $\cT_{<\alpha}$ gets larger, $\Delta(\cS_{\cT_{<\alpha}})$ gets smaller, so $\cT_\alpha$ gets larger. Thus, if $\alpha\le\beta$, then $\cT_\alpha\subseteq\cT_\beta$.

Now suppose that $\cT_{<\alpha}$ is inconsistent for some $\alpha$; let $\alpha$ be minimal with this property. Then $\cT_{<\beta}$ is consistent for all $\beta<\alpha$, and hence $\cT_\beta$ is consistent as well. But then by compactness and the fact that $\cT_\beta$ is increasing in $\beta$, so is $\cT_{<\alpha}$, contradiction.
\begin{theorem}
$\cT$ is an enlightened theory.
\end{theorem}
\begin{proof}
First, note that if $T_{\alpha}= T_{\alpha+1}$ for any $\alpha$, then $T_{<\alpha+2} = T_{<\alpha+1}$ so $T_{\alpha+2} = T_{\alpha+1} = T_\alpha$; by induction, we see that $T_\beta = T_\alpha$ for every $\beta\ge\alpha$. But we can only have $T_{\alpha}\subsetneq T_{\alpha+1}$ for countably many $\alpha$, since there are only countably many sentences of~$\cL$. Thus, the sequence must stabilize at some countable ordinal $\alpha^*$, and we have $\cT = \cT_{\alpha^*}$. Since $\cT_{<\alpha^*}$ is consistent, there is some $\nu\in\Delta(\cS_{\cT_{<\alpha^*}})$, and therefore $(\cU,\nu)\vdash\cT$, showing that $\cT$ is meditative. By construction, it is also clear that $\cT\vdash\zfcp$ as well as $\cT\vdash P[\vp]=1$ for all $\vp\in\cT$.
\end{proof}
We are now justified in making the following definition.
\begin{definition}
Let $\zfch$ denote the least enlightened theory.
\end{definition}
It may seem like $\zfch$ asserts its own consistency, and that something must therefore be wrong with our reasoning. But any finite collection of axioms of $\zfch$ merely asserts that some extension of $\zfcp$ with finitely many additional axioms is consistent; this is nothing unusual, since $\zfc$ also proves the consistency of any given finite subset of $\zfc$, and similarly for $\pa$.
\section{Nonstandard Models of PA and the Reflection Principle}
\label{nonstandard-models}
%%fakesubsection
Having built up some machinery in the previous section, we are now ready to prove some results about the reflection principle and standard models of PA. We prove that reflective, coherent~$\PP$'s  assign zero probability to standard models. We take this as further evidence that a weaker reflection principle is needed if we wish to use this framework for ordinary mathematics.
\subsection{Assigning Probabilities to Sets of Standard Theories of PA}
The following definition is different from our standard definition of $P$. 
We will be working in the realm of first-order arithmetic.
In order to not be distracted by the additional machinery of ZFC, we weaken our definition of $P$, as we cannot define functions in the usual way within Peano Arithmetic.
It is sufficient for $P$ to be a three place relation which arbitrarily approximates a metalanguage function.
\begin{definition}
Let $L'$ be the extension of the language $L$ (which itself extends the language of arithmetic) by a relation symbol $P$.
A \emph{standard theory} is a complete theory over $L'$ which extends the theory of the standard model of the naturals where $P\subset\mathbb{N}$ and 
$$\exists f : L'\rightarrow[0, 1] \text{ s.t. } \forall \vp~\forall a, b: (\ulcorner \vp \urcorner, a, b) \in P \iff f(\vp) \in (a, b).$$
\end{definition}
Intuitively, $P$ is a three-valued relation which approximates some function $f$ arbitrarily well. 
We imagine $(\q{\vp},a,b)\in P$ to mean that $a<f(\vp)<b$.

We would like to construct coherent, reflective distributions which are supported on standard theories of Peano Arithmetic.
Not only do such distributions not exist, but every coherent, reflective distribution must assign zero probability to any set of standard theories. 
However, there exists a restriction of $\PP$ which is a finitely additive measure supported on standard theories which satisfies an analogue of the reflection principle.
\begin{theorem} \emph{Disbelief in Standard Theories.}
Let $T$ be a consistent theory which extends Peano Arithmetic.
Let $\nu\in\Delta(\mathcal{S})$.
Then $\nu$ assigns probability zero to any set of standard theories of $T$.
\end{theorem}
\begin{proof}
%TODO MATH copy stuff from the forum post where I cleaned this stuff up for this and next proof
Consider the sentence $G$ defined by $G \iff P(G) < 1$.
Then, $\PP(G)=1$. (Recall that $\PP(\phi):=\nu({T:\phi\in T})$.)
Applying the reflection principle, we get that 
$$\forall\epsilon>0: \nu(\{T:1-\epsilon<P(G)<1\in T\})=1$$
Now, 
$$\{T:\forall \epsilon>0,1-\epsilon<P(G)<1\in T\}$$
$$=\bigcap_{\epsilon>0}\{T:1-\epsilon<P(G)<1\in T\},$$ so we apply countable additivity and De Morgan's laws to get that $$\nu(\{T:\forall \epsilon>0,1-\epsilon<P(G)<1\in T\})=1.$$
This means that any theory which does not have $\forall \epsilon>0,1-\epsilon<P(G)<1$ as an axiom, will be assigned probability zero by $\nu$.
In particular, no standard theory can have such an axiom, as otherwise it would contain a number smaller than one which was also greater than any standard rational smaller than one.
\end{proof}
While this seems problematic, we can trace this disbelief in standard theories back to the countable additivity condition. We now construct a finitely additive measure which fulfills many of our desiderata and is supported on standard theories.
\begin{definition}
Define the set $N$ to be the set of all standard theories. A subset $N_{\vp}$ of $N$ is defined as $N_{\vp}:=\{T:\vp\in T\}$.
\end{definition}
\begin{definition}
Define a function $\mu(N_{\vp}):=\PP(\vp)$.
\end{definition}
\begin{definition}
We define our base theory $T:=\bigcap N$.
\end{definition}
\begin{theorem} \emph{Existence of Finitely Additive Measure Supported on Standard Theories}
$\mu$ is well-defined, finitely additive, and satisfies a version of the reflection principle:
$$a < \mu(S_{\vp}) < b \rightarrow \mu(S_{a < P(\ulcorner \vp \urcorner) < b}) = 1.$$
\end{theorem}
\begin{proof}
We first show that $\mu$ is well-defined. By consistency of the reflection principle, we have that there exists a coherent, reflective $\PP$ over our base theory $T$.
Say that $N_{\vp}=N_{\psi}$. Then, by definition, $\vp$ and \$psi are in the same complete theories, so they must be logically equivalent. Therefore, $T$ proves $\vp\leftrightarrow\psi$, so by Gaifman coherence, $\PP(\vp)=\PP(\psi)$. Hence, $\mu$ is well defined.
We now check that $\mu$ is a finitely additive measure. Clearly, $\mu(\vp)\in[0,1]$ and $\mu(\emptyset)=\PP(\bot)=0$.
We need only check it is finitely additive. 
$$\mu(N_{\vp}\cup N_{\psi})=\mu(N_{\vp\vee\psi})=\PP(\vp\vee\psi)$$
If $N_{\vp}\cup N_{\psi}=\emptyset$, then we must have that $T$ proves $\neg(\vp\cup\psi)$, so 
$$\PP(\vp\vee\psi)=\PP(\vp)+\PP(\psi)$$
By the way we defined it, $\mu$ clearly satisfies the modified reflection principle we gave.
\end{proof}

\ifprocrastinate
\subsection{The Procrastination Paradox}
% We construct a bad thing...
% Fix the sentence to say "yes in fact this is a problem"
The support on nonstandard theories may seem suspicious, but it is not immediately obvious whether or not it causes problems in applications of the system. In this section, we show an analogue of a result about nonstandard theories of arithmetic called the \emph{procrastination paradox}~\cite{yudkowsky13}. 

Consider an immortal rational agent trying to decide whether to do a certain necessary task today, or postpone it till tomorrow; we imagine that it is very important that this task get done \emph{eventually}, but it does not matter \emph{when} the task is done. In the original form of the procrastination paradox, we imagine that our agent will do the task today \emph{unless it can prove in a certain formal system that it will do the task at a later time}, in which case our agent decides that for the moment, it can procrastinate.

Informally, the problem arises if the agent trusts the reasoning of future versions of itself too much; then, it reasons that tomorrow, it will either press the button or show that the button gets pressed at a later time, implying that in either case the button gets pressed, and it is therefore not necessary to press the button today. The agent reasons the same way at all future times, meaning that the button never actually gets pressed.

Formally, the original procrastination paradox shows that if a recursive sequence~$T_n$ of first-order theories extending Peano Arithmetic satisfies $T_n \vdash \square_{T_{n+1}}(\vp)\to\vp$ for every $n\in\NN$ and every sentence~$\vp$, where $\square_{T_{n+1}}(\vp)$ is the statement that~$\vp$ is provable in $T_{n+1}$, then all~$T_n$ have only nonstandard models.

The proof uses the diagonal lemma to define a predicate~$\vp(n) :\leftrightarrow \neg\square_{T_n}\big(\exists k>n{:}\;\vp(k)\big)$, where we interpret~$\vp(n)$ to mean that the agent presses the button at time~$n$; in other words, the agent presses the button iff it cannot find an argument that in~$T_n$ that the button will get pressed at some later time.

Then,~$T_n$ proves that $\vp(n+1)\vee\neg\vp(n+1)$, and that $\neg\vp(n+1)$ is equivalent to $\square_{T_{n+1}}\big(\exists k>n+1{:}\;\vp(k)\big)$, which (according to~$T_n$'s special axiom) implies~$\exists k>n+1{:}\;\vp(k)$; hence, $T_n$ proves $\vp(n+1)\vee\exists k>n+1{:}\;\vp(k)$, which immediately yields~$T_n\vdash\exists k>n{:}\;\vp(k)$. In other words, $\NN\vDash\forall n{:}\;\square_{T_n}\big(\exists k>n{:}\;\vp(k)\big)$. 

But this is equivalent to $\NN\vDash\forall n{:}\;\neg\vp(n)$; in other words, all~$T_n$ are unsound on the standard model. However, the $T_n$ can nevertheless be~\emph{consistent} (see~\cite{yudkowsky13}), implying that they have \emph{nonstandard} models~$\cM_n$ which satisfy $\cM_n\vDash\exists k>n{:}\;\vp(k)$; thus, these models contain \emph{nonstandard} ``times''~$k$ at which the button does in fact get pressed.

We now formulate an analogue of this argument in terms of reflective, coherent probability  distributions.

\begin{definition}
Fix a definable sequence of rational numbers $\varepsilon_n > 0$ such that $\varepsilon_n\to0$ (for example, we may set $\varepsilon_n := 2^{-n}$). Use the diagonal lemma to define a predicate~$\vp(n)$ such that $\zfc\;\vdash\;\vp(n)\,\leftrightarrow\, P[\exists k>n{:}\;\vp(k)] \,<\, 1 - \varepsilon_n$.
\end{definition}

Intuitively, the following theorem says that the agent believes for certain that it will press the button eventually.
\begin{theorem} \emph{Procrastination}
For all $n\in\NN$, $\PP(\exists k>n{:}\;\vp(k)) = 1$.
\end{theorem}
\begin{proof}
Suppose not. Then there is an $n_0\in\NN$ such that $\PP(\exists k>n_0{:}\;\vp(k))$ is less than one, and therefore less than~$1 - \varepsilon_n$ for some~$n>n_0$. Since $\exists k>n_0{:}\;\vp(k)$ is implied by $\exists k>n{:}\; \vp(k)$, the former statement must be at least as probable as the latter one, i.e., $1 - \varepsilon_n \;>\; \PP(\exists k>n_0{:}\; \vp(k)) \;\ge\; \PP(\exists k>n{:}\;\vp(k))$, and hence by the reflection principle
\[
\PP(\vp(n)) \;\;=\;\; \PP(P(\exists k>n{:}\;\vp(k)) \,<\, 1 - \varepsilon_n) \;\;=\;\; 1.
\]
But this implies $\PP(\exists k>n_0{:}\;\vp(k)) = 1$, contradicting our assumption that this probability is less than one.
\end{proof}
Intuitively, the following theorem says that even though the system is certain that it will eventually press the button, it does not in fact do so.
\begin{theorem}
For all $n\in\NN$, $\PP(\vp(n)) = 0$.
\end{theorem}
\begin{proof}
By the previous theorem, $\PP(\exists k>n:\vp(k)) = 1 > 1 - \epsilon_n$, and thus
\[\PP(\vp(n)) \;\;=\;\; \PP(P(\exists k>n{:}\;\vp(k)) < 1 - \epsilon_n) \;\;=\;\; 0.\]
\end{proof}
These two results are not contradictory: They merely imply that~$\PP$ is supported on complete theories whose (nonstandard) models believe that the button gets pressed \emph{at some nonstandard time}, just as in the procrastination paradox for logical theories.
\fi
\section{Further Work}
\label{further-work}

The impossibility results of sections \ref{refl-refl} and \ref{nonstandard-models} indicate that our reflection principle may be too strong.
In order to devise a reflection principle which is simultaneously \emph{satisfied by $\PP$}
and \emph{assigned probability $1$ by $\PP$},
we could try to weaken property~\ref{reflection}.

A possible alternative reflection principle
is an approximate version of
the intuitively appealing identity $\Pc{\vp}{\Pq{\vp} = p} = p$,
which formalizes the notion of ``self-trust'' rather than ``self-knowledge.''
For example, we could consider the relaxation
\begin{gather*}
\forall \vp \in L' \; \forall a, b \in \mathbb{Q} \st \Po{\vp \wedge \of{\inOpen{\Pq{\vp}}}} \leq b \Po{\inClosed{\Pq{\vp}}} \\
\forall \vp \in L' \; \forall a, b \in \mathbb{Q} \st \Po{\vp \wedge \of{\inClosed{\Pq{\vp}}}} \geq a \Po{\inOpen{\Pq{\vp}}}
\end{gather*}
This is strictly weaker than the reflection principle in this paper,
so our result implies that there exist coherent distributions satisfying this principle.
Moreover, no obvious analog of the Liar's paradox prevents this property
from being both satisfied by $\PP$ and having its inner language analogue assigned probability one by $\PP$.

It remains open whether it is possible to devise a principle
which captures the important aspects of reflection,
and which can be simultaneously true of a distribution $\PP$
while having its inner language analogue assigned probability one by $\PP$.
Additionally, it is an open question whether a reflection principle for measures supported on standard models can satisfy the reflective properties we care about.
\section{Acknowledgements}
The authors would like to thank Steve Rayhawk, Nate Soares, Patrick LaVictoire, Kenny Easwaran, Tsvi Benson-Tilsen, and Diego Caleiro for their help with this paper.

%%fakesection References
% bibtex handles this
\bibliography{reflection}
\bibliographystyle{abbrv}
\end{document}
